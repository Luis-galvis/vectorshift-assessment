{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\lgalv\\\\Desktop\\\\integrations_technical_assessment\\\\frontend\\\\src\\\\integrations\\\\hubspot.js\",\n  _s = $RefreshSig$();\nimport { useState, useEffect } from 'react';\nimport { Box, Button, CircularProgress } from '@mui/material';\nimport axios from 'axios';\n\n// frontend/src/integrations/hubspot.js\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport const HubspotIntegration = ({\n  user,\n  org,\n  setIntegrationParams\n}) => {\n  _s();\n  const [isConnecting, setIsConnecting] = useState(false);\n  const handleConnect = async () => {\n    try {\n      setIsConnecting(true);\n\n      // Paso 1: Obtener URL de autorización\n      const authResponse = await fetch('http://localhost:8000/integrations/hubspot/authorize', {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json'\n        },\n        body: JSON.stringify({\n          user_id: user,\n          org_id: org\n        })\n      });\n      if (!authResponse.ok) throw new Error('Error al obtener URL de autorización');\n      const {\n        url\n      } = await authResponse.json();\n      const authWindow = window.open(url, 'HubSpot Auth', 'width=600,height=600');\n\n      // Paso 2: Verificar credenciales después de cerrar ventana\n      const checkCredentials = async () => {\n        const credentialsResponse = await fetch('http://localhost:8000/integrations/hubspot/credentials');\n        if (credentialsResponse.ok) {\n          const credentials = await credentialsResponse.json();\n          setIntegrationParams({\n            credentials: credentials.access_token,\n            type: 'HubSpot'\n          });\n        }\n        setIsConnecting(false);\n      };\n      const interval = setInterval(() => {\n        if (authWindow.closed) {\n          clearInterval(interval);\n          checkCredentials();\n        }\n      }, 500);\n    } catch (error) {\n      console.error('Error de conexión:', error);\n      setIsConnecting(false);\n    }\n  };\n  return /*#__PURE__*/_jsxDEV(\"button\", {\n    onClick: handleConnect,\n    disabled: isConnecting,\n    style: {\n      padding: '10px 20px',\n      backgroundColor: isConnecting ? '#cccccc' : '#ff7a59',\n      color: 'white',\n      border: 'none',\n      borderRadius: '4px',\n      cursor: 'pointer'\n    },\n    children: isConnecting ? 'Conectando...' : 'Conectar con HubSpot'\n  }, void 0, false, {\n    fileName: _jsxFileName,\n    lineNumber: 55,\n    columnNumber: 9\n  }, this);\n};\n// Configuración para el formulario\n_s(HubspotIntegration, \"wFTzW8g/nX5ciJ7yP5KH8paCcIk=\");\n_c = HubspotIntegration;\nexport const HubspotConfig = {\n  name: 'HubSpot',\n  slug: 'hubspot',\n  authorizeUrl: '/integrations/hubspot/authorize'\n};\nvar _c;\n$RefreshReg$(_c, \"HubspotIntegration\");","map":{"version":3,"names":["useState","useEffect","Box","Button","CircularProgress","axios","jsxDEV","_jsxDEV","HubspotIntegration","user","org","setIntegrationParams","_s","isConnecting","setIsConnecting","handleConnect","authResponse","fetch","method","headers","body","JSON","stringify","user_id","org_id","ok","Error","url","json","authWindow","window","open","checkCredentials","credentialsResponse","credentials","access_token","type","interval","setInterval","closed","clearInterval","error","console","onClick","disabled","style","padding","backgroundColor","color","border","borderRadius","cursor","children","fileName","_jsxFileName","lineNumber","columnNumber","_c","HubspotConfig","name","slug","authorizeUrl","$RefreshReg$"],"sources":["C:/Users/lgalv/Desktop/integrations_technical_assessment/frontend/src/integrations/hubspot.js"],"sourcesContent":["import { useState, useEffect } from 'react';\r\nimport { Box, Button, CircularProgress } from '@mui/material';\r\nimport axios from 'axios';\r\n\r\n// frontend/src/integrations/hubspot.js\r\nexport const HubspotIntegration = ({ user, org, setIntegrationParams }) => {\r\n    const [isConnecting, setIsConnecting] = useState(false);\r\n\r\n    const handleConnect = async () => {\r\n        try {\r\n          setIsConnecting(true);\r\n            \r\n            // Paso 1: Obtener URL de autorización\r\n            const authResponse = await fetch('http://localhost:8000/integrations/hubspot/authorize', {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json',\r\n                },\r\n                body: JSON.stringify({ user_id: user, org_id: org })\r\n            });\r\n\r\n            if (!authResponse.ok) throw new Error('Error al obtener URL de autorización');\r\n            \r\n            const { url } = await authResponse.json();\r\n            const authWindow = window.open(url, 'HubSpot Auth', 'width=600,height=600');\r\n\r\n            // Paso 2: Verificar credenciales después de cerrar ventana\r\n            const checkCredentials = async () => {\r\n                const credentialsResponse = await fetch('http://localhost:8000/integrations/hubspot/credentials');\r\n                \r\n                if (credentialsResponse.ok) {\r\n                    const credentials = await credentialsResponse.json();\r\n                    setIntegrationParams({\r\n                        credentials: credentials.access_token,\r\n                        type: 'HubSpot'\r\n                    });\r\n                }\r\n                setIsConnecting(false);\r\n            };\r\n\r\n            const interval = setInterval(() => {\r\n                if (authWindow.closed) {\r\n                    clearInterval(interval);\r\n                    checkCredentials();\r\n                }\r\n            }, 500);\r\n\r\n        } catch (error) {\r\n            console.error('Error de conexión:', error);\r\n            setIsConnecting(false);\r\n        }\r\n    };\r\n\r\n    return (\r\n        <button \r\n            onClick={handleConnect}\r\n            disabled={isConnecting}\r\n            style={{ \r\n                padding: '10px 20px',\r\n                backgroundColor: isConnecting ? '#cccccc' : '#ff7a59',\r\n                color: 'white',\r\n                border: 'none',\r\n                borderRadius: '4px',\r\n                cursor: 'pointer'\r\n            }}\r\n        >\r\n            {isConnecting ? 'Conectando...' : 'Conectar con HubSpot'}\r\n        </button>\r\n    );\r\n};\r\n// Configuración para el formulario\r\nexport const HubspotConfig = {\r\n    name: 'HubSpot',\r\n    slug: 'hubspot',\r\n    authorizeUrl: '/integrations/hubspot/authorize'\r\n};"],"mappings":";;AAAA,SAASA,QAAQ,EAAEC,SAAS,QAAQ,OAAO;AAC3C,SAASC,GAAG,EAAEC,MAAM,EAAEC,gBAAgB,QAAQ,eAAe;AAC7D,OAAOC,KAAK,MAAM,OAAO;;AAEzB;AAAA,SAAAC,MAAA,IAAAC,OAAA;AACA,OAAO,MAAMC,kBAAkB,GAAGA,CAAC;EAAEC,IAAI;EAAEC,GAAG;EAAEC;AAAqB,CAAC,KAAK;EAAAC,EAAA;EACvE,MAAM,CAACC,YAAY,EAAEC,eAAe,CAAC,GAAGd,QAAQ,CAAC,KAAK,CAAC;EAEvD,MAAMe,aAAa,GAAG,MAAAA,CAAA,KAAY;IAC9B,IAAI;MACFD,eAAe,CAAC,IAAI,CAAC;;MAEnB;MACA,MAAME,YAAY,GAAG,MAAMC,KAAK,CAAC,sDAAsD,EAAE;QACrFC,MAAM,EAAE,MAAM;QACdC,OAAO,EAAE;UACL,cAAc,EAAE;QACpB,CAAC;QACDC,IAAI,EAAEC,IAAI,CAACC,SAAS,CAAC;UAAEC,OAAO,EAAEd,IAAI;UAAEe,MAAM,EAAEd;QAAI,CAAC;MACvD,CAAC,CAAC;MAEF,IAAI,CAACM,YAAY,CAACS,EAAE,EAAE,MAAM,IAAIC,KAAK,CAAC,sCAAsC,CAAC;MAE7E,MAAM;QAAEC;MAAI,CAAC,GAAG,MAAMX,YAAY,CAACY,IAAI,CAAC,CAAC;MACzC,MAAMC,UAAU,GAAGC,MAAM,CAACC,IAAI,CAACJ,GAAG,EAAE,cAAc,EAAE,sBAAsB,CAAC;;MAE3E;MACA,MAAMK,gBAAgB,GAAG,MAAAA,CAAA,KAAY;QACjC,MAAMC,mBAAmB,GAAG,MAAMhB,KAAK,CAAC,wDAAwD,CAAC;QAEjG,IAAIgB,mBAAmB,CAACR,EAAE,EAAE;UACxB,MAAMS,WAAW,GAAG,MAAMD,mBAAmB,CAACL,IAAI,CAAC,CAAC;UACpDjB,oBAAoB,CAAC;YACjBuB,WAAW,EAAEA,WAAW,CAACC,YAAY;YACrCC,IAAI,EAAE;UACV,CAAC,CAAC;QACN;QACAtB,eAAe,CAAC,KAAK,CAAC;MAC1B,CAAC;MAED,MAAMuB,QAAQ,GAAGC,WAAW,CAAC,MAAM;QAC/B,IAAIT,UAAU,CAACU,MAAM,EAAE;UACnBC,aAAa,CAACH,QAAQ,CAAC;UACvBL,gBAAgB,CAAC,CAAC;QACtB;MACJ,CAAC,EAAE,GAAG,CAAC;IAEX,CAAC,CAAC,OAAOS,KAAK,EAAE;MACZC,OAAO,CAACD,KAAK,CAAC,oBAAoB,EAAEA,KAAK,CAAC;MAC1C3B,eAAe,CAAC,KAAK,CAAC;IAC1B;EACJ,CAAC;EAED,oBACIP,OAAA;IACIoC,OAAO,EAAE5B,aAAc;IACvB6B,QAAQ,EAAE/B,YAAa;IACvBgC,KAAK,EAAE;MACHC,OAAO,EAAE,WAAW;MACpBC,eAAe,EAAElC,YAAY,GAAG,SAAS,GAAG,SAAS;MACrDmC,KAAK,EAAE,OAAO;MACdC,MAAM,EAAE,MAAM;MACdC,YAAY,EAAE,KAAK;MACnBC,MAAM,EAAE;IACZ,CAAE;IAAAC,QAAA,EAEDvC,YAAY,GAAG,eAAe,GAAG;EAAsB;IAAAwC,QAAA,EAAAC,YAAA;IAAAC,UAAA;IAAAC,YAAA;EAAA,OACpD,CAAC;AAEjB,CAAC;AACD;AAAA5C,EAAA,CAjEaJ,kBAAkB;AAAAiD,EAAA,GAAlBjD,kBAAkB;AAkE/B,OAAO,MAAMkD,aAAa,GAAG;EACzBC,IAAI,EAAE,SAAS;EACfC,IAAI,EAAE,SAAS;EACfC,YAAY,EAAE;AAClB,CAAC;AAAC,IAAAJ,EAAA;AAAAK,YAAA,CAAAL,EAAA"},"metadata":{},"sourceType":"module","externalDependencies":[]}